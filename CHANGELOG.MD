# Changelog

Toutes les modifications notables de ce projet sont document√©es dans ce fichier.

Le format est bas√© sur [Keep a Changelog](https://keepachangelog.com/fr/1.0.0/),
et ce projet adh√®re au [Semantic Versioning](https://semver.org/lang/fr/).

## [1.0.0] - 2024-12-02

### ‚úÖ Ajout√©

#### S√©curit√©
- **Cookies HTTPOnly** : Stockage du token JWT dans un cookie HTTPOnly au lieu de localStorage pour pr√©venir les attaques XSS
- **Helmet.js** : Configuration des headers de s√©curit√© HTTP (X-Frame-Options, CSP, HSTS, etc.)
- **express-mongo-sanitize** : Protection contre les injections NoSQL
- **Rate Limiting** : Limitation des tentatives de connexion (5/15min) et des requ√™tes g√©n√©rales (100/15min)
- **Validation Joi** : Sch√©mas de validation stricts pour toutes les routes (auth, orders, products)
- **CORS s√©curis√©** : Configuration stricte avec liste blanche d'origines autoris√©es

#### Fonctionnalit√©s
- **Authentification JWT** : Syst√®me complet login/register/logout
- **Gestion des r√¥les** : S√©paration user/admin avec middleware de v√©rification
- **Panier d'achat** : Context API React avec gestion des quantit√©s
- **Gestion des produits** : CRUD complet avec contr√¥le de stock
- **Gestion des commandes** : Cr√©ation, suivi de statut, validation admin
- **Syst√®me de notification** : Microservice pour envoi d'emails
- **Gestion des stocks** : Microservice de mise √† jour automatique

#### Infrastructure
- **Docker** : Dockerfiles pour backend/frontend + docker-compose.yml orchestrant MongoDB
- **CI/CD** : GitHub Actions pour d√©ploiement automatis√©
- **Logging** : Winston pour logs structur√©s (info, warn, error)
- **Health Check** : Endpoint `/health` pour monitoring

### üîß Corrig√©

#### Vuln√©rabilit√©s critiques
- **[CRITIQUE]** Suppression des logs de mots de passe en clair (authController.js:12)
- **[CRITIQUE]** Suppression des logs de tokens JWT (authController.js:24)
- **[CRITIQUE]** Suppression des logs d'objets user complets avec hash password (authController.js:17,48)
- **[√âLEV√âE]** Messages d'erreur g√©n√©riques pour login (ne r√©v√®le plus si user existe)
- **[√âLEV√âE]** Ajout de validation du r√¥le utilisateur avec enum ('user', 'admin')
- **[√âLEV√âE]** Ajout du flag `secure: true` sur les cookies en production
- **[MOYENNE]** Correction de la validation JWT avec gestion synchrone au lieu de callback dans try/catch
- **[MOYENNE]** Ajout de limitation de taille de payload (10kb max)
- **[MOYENNE]** Augmentation de l'exigence de mot de passe (6 caract√®res min avec maj/min/chiffre)

#### Bugs fonctionnels
- **Panier** : Correction du calcul du badge (affiche maintenant la quantit√© totale d'objets, pas le nombre de produits diff√©rents)
- **Panier** : Correction de l'ajout de produit avec quantit√© personnalis√©e (respecte maintenant action.payload.quantity)
- **Admin seeder** : Ajout d'un compte admin par d√©faut (username: admin, password: admin)
- **URL dynamiques** : Remplacement des URL en dur par des variables d'environnement

### üöÄ Am√©lior√©

#### Performance
- **Payload limit√©** : Requ√™tes limit√©es √† 10kb pour pr√©venir les attaques DoS
- **Cache CORS** : Preflight OPTIONS cach√©es 24h (maxAge: 86400)
- **Index MongoDB** : Champs unique index√©s (email, username)

#### Code Quality
- **JSDoc** : Documentation compl√®te des fonctions backend avec types et exemples
- **Commentaires React** : Documentation de tous les composants et hooks personnalis√©s
- **Logger Winston** : Remplacement des console.log par un syst√®me de logging structur√©
- **Gestion d'erreurs** : Middleware global de gestion des erreurs avec logging
- **S√©paration des pr√©occupations** : Architecture en couches (routes ‚Üí controllers ‚Üí services ‚Üí models)

#### DX (Developer Experience)
- **Scripts NPM** : Scripts Docker (docker:up, docker:down, docker:logs, etc.)
- **Variables d'environnement** : Configuration centralis√©e avec .env.example
- **.dockerignore** : Optimisation des builds Docker
- **Health check endpoint** : Monitoring de l'√©tat du serveur

### üóëÔ∏è Supprim√©
- Logs de donn√©es sensibles (passwords, tokens, user objects complets)
- URL hardcod√©es dans le code
- Header `X-Powered-By: Express` (via Helmet)
- Code comment√© obsol√®te dans orderController.js

### üìù Documentation
- **README.md** : Instructions compl√®tes d'installation et configuration
- **DOCKER.md** : Guide Docker avec commandes et troubleshooting
- **JSDoc** : Documentation inline de toutes les fonctions backend
- **Commentaires** : Tous les composants React document√©s
- **API Documentation** : Sch√©mas de validation d√©taill√©s avec messages d'erreur explicites

### üîê S√©curit√© - R√©capitulatif des corrections

| Vuln√©rabilit√© | S√©v√©rit√© | Status | Correction |
|---------------|----------|--------|------------|
| Logs de mots de passe | CRITIQUE | ‚úÖ | Supprim√©s |
| Logs de tokens JWT | CRITIQUE | ‚úÖ | Supprim√©s |
| Absence de rate limiting | CRITIQUE | ‚úÖ | Impl√©ment√© (express-rate-limit) |
| Injection NoSQL | CRITIQUE | ‚úÖ | express-mongo-sanitize ajout√© |
| Absence de Helmet | √âLEV√âE | ‚úÖ | Helmet configur√© |
| Cookie non secure | √âLEV√âE | ‚úÖ | Flag secure en production |
| Messages d'erreur r√©v√©lateurs | √âLEV√âE | ‚úÖ | Messages g√©n√©riques |
| Validation r√¥le manquante | √âLEV√âE | ‚úÖ | Enum ajout√© au mod√®le |
| Absence de CSRF | √âLEV√âE | ‚ö†Ô∏è | SameSite strict (partiel) |
| Validation JWT incorrecte | MOYENNE | ‚úÖ | Refactoris√©e |
| Payload illimit√© | MOYENNE | ‚úÖ | Limite 10kb |
| Mot de passe faible | MOYENNE | ‚úÖ | 6 car + complexit√© |

## [0.1.0] - 2024-11-XX

### ‚úÖ Ajout√©
- Version initiale du projet
- Structure backend Express avec MongoDB
- Frontend React avec Tailwind CSS
- Authentification basique

---

## L√©gende

- ‚úÖ **Ajout√©** : Nouvelles fonctionnalit√©s
- üîß **Corrig√©** : Corrections de bugs et vuln√©rabilit√©s
- üöÄ **Am√©lior√©** : Am√©liorations de fonctionnalit√©s existantes
- üóëÔ∏è **Supprim√©** : Fonctionnalit√©s ou code supprim√©s
- üìù **Documentation** : Modifications de documentation
- üîê **S√©curit√©** : Corrections de vuln√©rabilit√©s